#ifndef TDCB_BUFFER_H
#define TDCB_BUFFER_H

// Definitions in the block header (TEL62-specific) only:
#define TDCB_FORMAT_IDENTIFIER_MASK 0xff000000
#define TDCB_FORMAT_IDENTIFIER_RSHIFT 24
#define TDCB_DATA_SOURCE_SUB_ID_MASK 0x00ff0000
#define TDCB_DATA_SOURCE_SUB_ID_RSHIFT 16
#define TDCB_L0_TRIGGER_TYPE_MASK 0x0000ff00
#define TDCB_L0_TRIGGER_TYPE_RSHIFT 8
#define TDCB_FPGA_ID_BOARD_HEADER_MASK 0x000000ff
#define TDCB_FPGA_ID_BOARD_HEADER_RSHIFT 0
#define TDCB_SPECIAL_TRIGGER_NWORDS_MASK 0x00000fff
#define TDCB_SPECIAL_TRIGGER_NWORDS_RSHIFT 0

// Definitions in the FPGA header only:
#define TDCB_FLAG_ERROR_MASK 0x01000000
#define TDCB_FLAG_ERROR_RSHIFT 24
#define TDCB_FPGA_ID_MASK 0x00ff0000
#define TDCB_FPGA_ID_RSHIFT 16
#define TDCB_NUMBER_OF_SLOT_MASK 0x000000ff
#define TDCB_NUMBER_OF_SLOT_RSHIFT 0

// Definitions in frame header only:

#define TDCB_NUMBER_OF_WORDS 0xffff0000
#define TDCB_NUMBER_OF_WORDS_RSHIFT 16
#define TDCB_SLOT_TIME_STAMP 0x0000ffff
#define TDCB_SLOT_TIME_STAMP_RSHIFT 0

// Definitions in the measurement word:
#define TDCB_TYPE_MASK  0xf0000000  // Data type field
#define TDCB_ERROR  0x60000000  // TDC Error flag.
#define TDCB_LEADING  0x40000000 
#define TDCB_TRAILING  0x50000000 
#define TDCB_CHANNEL_MASK 0x00f80000 
#define TDCB_CHANNEL_RSHIFT 19 
#define TDCB_TDC_MASK 0x03000000 
#define TDCB_TDC_RSHIFT 24 
#define TDCB_DATA_MASK  0x0007ffff 

// FPGA IDs
#define TDCB_FLAG_PP_FPGA0_MASK 0x00000001
#define TDCB_FLAG_PP_FPGA1_MASK 0x00000002
#define TDCB_FLAG_PP_FPGA2_MASK 0x00000004
#define TDCB_FLAG_PP_FPGA3_MASK 0x00000008
#define TDCB_FLAG_SL_FPGA_MASK 0x00000010
#define TDCB_PP_FPGA0_FLAG_RSHIFT 0
#define TDCB_PP_FPGA1_FLAG_RSHIFT 1
#define TDCB_PP_FPGA2_FLAG_RSHIFT 2
#define TDCB_PP_FPGA3_FLAG_RSHIFT 3
#define TDCB_SL_FPGA_FLAG_RSHIFT 4

// Error frame
#define TDCB_NUMBER_OF_ERROR_WORDS 0xffff0000
#define TDCB_NUMBER_OF_ERROR_WORDS_RSHIFT 16
#define TDCB_NUMBER_OF_ERROR_WORDS_FRAME0 0x000000ff
#define TDCB_NUMBER_OF_ERROR_WORDS_FRAME0_RSHIFT 0
#define TDCB_NUMBER_OF_ERROR_WORDS_FRAME1 0x0000ff00
#define TDCB_NUMBER_OF_ERROR_WORDS_FRAME1_RSHIFT 8

//TEL62 Error flags
#define TDCB_TEL62_ERROR_WORD_ID_MASK 0xc0000000
#define TDCB_TEL62_ERROR_WORD_ID_RSHIFT 30

#endif // TDCB_BUFFER_H
