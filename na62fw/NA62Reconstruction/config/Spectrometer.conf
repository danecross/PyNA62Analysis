### Spectrometer configuration file ###

######################## Common parameters to all the subdetectors ########################
#
# The following parameters are read by NA62VReconstruction::ParseConfigFile
#

# Data source ID as specified in "NA62 Data Formats": 8-bit identifier specifying the sub-detector generating the data
# expressed in hexadecimal
DetID= 0x14

# Total number of stations
NStations= 1

# Total number of channels
NChannels= 7680

# Enable (1) or disable (0) T0 and StationsT0
EnableStationsT0= 1
EnableTriggerDriftT0= 1
EnableROMezzaninesT0= 1
EnableT0= 1

# Names of files containing the MezzanineT0 and T0 constants
ROMezzaninesT0FileInput= Spectrometer-CoarseT0.dat
T0FileInput= Spectrometer-T0.dat

# Enable (1) or disable (0) histograms for T0 evaluation
# bit 0: T0 histo (to cross-check T0 evaluation)
# bit 1: NoT0 histo (to evaluate fineT0s)
# bit 2: PrimNoT0 histo (to evaluate fineT0s for L0)
T0HistoMask= 0

# Enable (1) or disable (0) histograms for individual channels
EnableChannelHistograms= 0

# header text file output by encoding to be used in input for L1 trigger tests
# this will contain the recipe to process the binary file: 
# general info - binary filename, sub-detector ID, number of readout boards, number of processed events
# event-based info - event length, event timestamp, event length per readout board
HeaderFileName= Spectrometer_header.txt   
  
# raw binary file output by encoding to be used in input for L1 trigger tests (together with header text file) 
# this will contain the event data block as specified in "NA62 Data Formats"
BinaryFileName= Spectrometer.dat

# ------------------------------- Digitizer configuration ------------------------------- #
# Station MC ToF (ns) [one value for each station]
StationsMCToF= 0

# ----------------------------- Online Monitor configuration ---------------------------- #
# Set the number of bursts after which the OM histos are reset 
# If the value is <=0 the OM histos are never reset
OnlineMonitorAccumulation= 1

############################### Spectrometer Reconstruction ###############################

RunType = kaon
# TimeReference: use trigger fine time (Trigger) or CHOD (CHOD) as reference time [but t=0 used for MC]
TimeReference = Trigger
StationsAlignmentFileInput = Spectrometer-StationsAlignment.dat
AlignmentFileInput = Spectrometer-Alignment.dat
ZOffsetFileInput = Spectrometer-ZOffset.dat
BxIntegralFileInput = Spectrometer-MNP33-BxIntegral.dat
ByIntegralFileInput = Spectrometer-MNP33-ByIntegral.dat
BMNP33FileInput = Spectrometer-MNP33-Bmap.dat
BFringeFileInput = Spectrometer-Fringe-Bmap.dat
RTFileInput = Spectrometer-RT.dat
XTFileInput = Spectrometer-XT.dat

#
#################### PARAMETERS FOR THE LEFT-RIGHT AMBIGUITY RESOLUTION ###################
Maximum_hits_per_plane= 9
TDrift_max= 170 ns
Ttrailing_cut_2hits= 150 ns
Ttrailing_sigma_3hits= 20 ns
Ttrailing_sigma_2hits= 25 ns
#RadiusSum_3hits= 8.0 11.0 mm
RadiusSum_3hits= 7.0 11.0 mm
RadiusSum_2hits= 7.5 mm
#Triplet_chi2= 7.5 
Triplet_chi2= 9.0 
Triplet_parameters= 0.5 3.9 4.45 0.2 mm
HalfView_staggering= 4.4 mm
Doublet_parameters= 3.0 7.0 2.5 
Difference_StrawHit_position= 9. mm
Max_Hit_Slope= 0.05
N_Slope_SigmaCut= 5 
#
########################### INPUTS FOR CHAMBER-HIT RECONSTRUCTION #########################
Intersection_ttrailing_cut= 100 ns
Intersection_distance_cut= 2.5 cm
4ViewIntersection_quality_cut= 10. 1. 20. 12. mm 
4ViewIntersection_ttrailing_sigma= 15 ns
3ViewIntersection_quality_cut= 10. 10. 10. 10. mm
3ViewIntersection_ttrailing_sigma= 20 ns
#
########################### INPUTS FOR TRACK PATTERN RECOGNITION ##########################
Combination_XCorridor= 150. 150. 200. 500. mm
Combination_YCorridor= 150. 150. 150. 150. mm
3HitsCombination_radiusatmc= 60. mm
Momentum_max= 90 GeV
Angle_max= 0.02
Combination_QualityCut= 5.
Combination_HoughDeltaCut= 5.
#
############################## INPUTS FOR TRACK RECONSTRUCTION ############################
####Guess_digi_sigma= 250. micrometer
Guess_digi_sigma= 245. micrometer
Guess_digisinglet_sigma= 10. mm
Z_reference_plane= 150 m
X/X0_per_plane= 0.0003
####Fit_residual_cuts_per_chamber= 250. 250. 350. 400. micrometer
####Fit_residual_cuts_per_chamber= 200. 200. 300. 350. micrometer
Fit_residual_cuts_per_chamber= 220. 220. 300. 350. micrometer
#
################################### MONITORING HISTOGRAMS #################################
# (3=all, 2=large histos removed, 1=only essential histograms, 0=none)
Histo_Monitor= 2
####################### SPECTROMETER DIGITIZER BASE RUN CONFIGURATION #####################
MaxTime= 250.0
TimeStep= 1
StrawT0= 4.5
NClustersPermm= 2.7
#Discriminator settling and dead times [ns]
DiscrSetTime= 20.0
EdgeDeadTime= 5.0
SameEdgeDeadTime= 12.0
#Discriminator threshold [fC]
Threshold= 6 
#Gas gain
Gain= 4500.0
#[mV/fC]
CARIOCASlope= 15.0
#ENC [fC]
EquivalentNoiseCharge= 3
#Gas ionization [eV]
IonizationEnergy= 28.1
NTotalPermm= 9.3
NoiseSimu= 0 
SavePulseShapes= 0
NoBulkHits= 0 
#
############################ INPUTS FOR PARAMETRIC DIGITIZATION ###########################
#TWindow= -600 400 ns
TWindow= -100 300 ns
#
################### SPECTROMETER RECONSTRUCTION BASE RUN CONFIGURATION ####################
Chambers,Views,Planes,Straws= 4 4 4 122
Null_coordinate= -9999 mm
#T0: MC Time of Flight from T10 for each view, plane (ns, up to 20)
ChambersMCToF= 611.505 646.725 681.395 729.515
ViewsMCToF= 0. 0.19 0.97 1.16 
PlanesMCToF= 0. 0.04 0.09 0.13
RTMode= 0
XTMode= 0

# Magic T0 file input
MagicT0FileInput= Spectrometer-MagicT0.dat

# RawDecoder channel mapping and other relevant parameters
RawDecoderSettingsFileInput= Spectrometer-RawDecoderSettings.dat
