### MUV3 configuration file ###

######################## Common parameters to all the subdetectors ########################
#
# The following parameters are read by NA62VReconstruction::ParseConfigFile
#

# Data source ID as specified in "NA62 Data Formats":
# 8-bit subdetector identifier expressed in hexadecimal format
DetID= 0x30

# Total number of stations
NStations= 1

# Total number of channels
NChannels= 512

# T0 corrections: the global ("station") T0 and the channel T0s are subtracted
# from the raw times at the Digi to RecoHit conversion step.

# Enable (1) or disable (0) StationsT0 and T0
EnableStationsT0= 1
EnableTriggerDriftT0= 1
EnableROMezzaninesT0= 1
EnableT0= 1

# Names of files containing the MezzanineT0 and T0 constants
ROMezzaninesT0FileInput= MUV3-CoarseT0.dat
T0FileInput= MUV3-T0.dat

# Enable (1) or disable (0) histograms for T0 evaluation
# bit 0: T0 histo (to cross-check T0 evaluation)
# bit 1: NoT0 histo (to evaluate fineT0s)
# bit 2: PrimNoT0 histo (to evaluate fineT0s for L0)
T0HistoMask= 3

# Enable (1) or disable (0) histograms for individual channels (normally enabled).
EnableChannelHistograms= 0

# header text file output by encoding to be used in input for L1 trigger tests
# this will contain the recipe to process the binary file: 
# general info - binary filename, sub-detector ID, number of readout boards, number of processed events
# event-based info - event length, event timestamp, event length per readout board
HeaderFileName= MUV3_header.txt

# raw binary file output by encoding to be used in input for L1 trigger tests (together with header text file)
# this will contain the event data block as specified in "NA62 Data Formats"
BinaryFileName= MUV3.dat

# ------------------------------- Digitizer configuration ------------------------------- #
# Station MC ToF (ns) [one value for each station]
StationsMCToF= 823.5

# ----------------------------- Online Monitor configuration ---------------------------- #
# Set the number of bursts after which the OM histos are reset 
# If the value is <=0 the OM histos are never reset
OnlineMonitorAccumulation= 10

################################### MUV3 Reconstruction ###################################

# Total number of tiles (central tiles 65, 66, 77, 78 do not exist)
NTiles= 152

# Width of the reconstruction time window (ns) = max dT between two PMTs in a tight candidate
TimeWindow= 5

# Edge requirement for the hit reconstruction:
#  1 = leading edge exists,  2 = trailing edge exists, 3 = leading+trailing edges exist (default)
#  0 = any hit, -1 = leading edge only, -2 = trailing edge only
# NB: trailing edges are switched off in 2016, therefore the edge requirement must be set to 1, -1 or 0.
EdgeRequirement= 1

# Enable (1) or disable (0) T0 corrections for tiles. Standard: enabled.
# T0 corrections must be enabled for evaluation of tile T0 corrections!
EnableT0Tiles= 1

# Name of file containing the tile T0 correction constants.
# This table is not optimal for MC: for two identical gaussian peaks with resolution T,
# the tile T0s shifts by 0.53*T as can be seen from MC simulation.
T0TilesFileInput= MUV3-TilesT0.dat

# Print candidate info for comparison with primitive dumps (normally disabled).
PrintCandidateInfo= 0

# Masked channel list handled by the conditions service
MaskedChannelInputFile= MUV3-MaskedChannelSettings.dat

# Control the reconstruction of the loose candidates.
# There are two types of loose candidates (both enabled by default).
# LooseMasked: partner channel is masked via the MaskedChannels card above;
# Loose:       partner channel is not masked but a tight candidate match is not found.
BuildLooseMaskedCandidates= 1
BuildLooseCandidates= 1

##################################### MUV3 Digitizer ######################################

# Mode: 1=simple digitizer, 2=detailed digitizer (default = 1)
DigitizerMode= 1

# Parameters of the simple digitizer
EnergyDepositThreshold =  4.0    # MeV
ChannelTimeResolution  =  0.450  # ns
ChannelMergeThreshold  = 15.000  # ns

# Parameters of the detailed digitizer
LightCollectionMatrixAFileName= MUV3-matrixA.dat
LightCollectionMatrixBFileName= MUV3-matrixB.dat
SignalShapeFileName=            MUV3-shape.dat
PMTransitTimeMean=   30.0
PMTransitTimeSpread=  2.8
QuantumEfficiency=    0.15
CableDelay=          61.0
CFDDelay=             4.5
CFDAttenuation=       5.4
CFDThreshold=        -0.15
CFDPulseWidth=       30.
TimeInterval=       200.
DeltaTime=            0.2
PhotonsPerMeV=    10000.

DigiDebugFlag=     0
DigiCFDDebugFlag=  0

# RawDecoder channel mapping and other relevant parameters
RawDecoderSettingsFileInput= MUV3-RawDecoderSettings.dat
